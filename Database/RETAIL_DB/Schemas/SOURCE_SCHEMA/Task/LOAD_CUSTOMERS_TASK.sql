   CREATE TASK RETAIL_DB.SOURCE_SCHEMA.LOAD_CUSTOMERS_TASK  WAREHOUSE = COMPUTE_WH  SCHEDULE = 'USING CRON 0 8 * * * America/Los_Angeles'  COMMENT = 'Task to load incremental customer data daily at 8 AM'  AS  MERGE INTO RETAIL_DB.INCREMENTAL_SCHEMA.CUSTOMERS tgt USING (SELECT * FROM RETAIL_DB.SOURCE_SCHEMA.CUSTOMERS src WHERE src.last_modified > (SELECT COALESCE(MAX(last_modified), '1900-01-01'::timestamp) FROM RETAIL_DB.INCREMENTAL_SCHEMA.CUSTOMERS)) src ON tgt.customer_id = src.customer_id WHEN MATCHED THEN UPDATE SET tgt.first_name = src.first_name, tgt.last_name = src.last_name, tgt.email = src.email, tgt.phone = src.phone, tgt.date_joined = src.date_joined, tgt.last_modified = src.last_modified WHEN NOT MATCHED THEN INSERT (customer_id, first_name, last_name, email, phone, date_joined, last_modified) VALUES (src.customer_id, src.first_name, src.last_name, src.email, src.phone, src.date_joined, src.last_modified); 