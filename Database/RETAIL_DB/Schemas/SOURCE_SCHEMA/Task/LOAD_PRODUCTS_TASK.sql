   CREATE TASK RETAIL_DB.SOURCE_SCHEMA.LOAD_PRODUCTS_TASK  WAREHOUSE = COMPUTE_WH  SCHEDULE = 'USING CRON 0 8 * * * America/Los_Angeles'  COMMENT = 'Task to load incremental product data daily at 8 AM'  AS  MERGE INTO RETAIL_DB.INCREMENTAL_SCHEMA.PRODUCTS tgt USING (SELECT * FROM RETAIL_DB.SOURCE_SCHEMA.PRODUCTS src WHERE src.last_modified > (SELECT COALESCE(MAX(last_modified), '1900-01-01'::timestamp) FROM RETAIL_DB.INCREMENTAL_SCHEMA.PRODUCTS)) src ON tgt.product_id = src.product_id WHEN MATCHED THEN UPDATE SET tgt.product_name = src.product_name, tgt.category_id = src.category_id, tgt.unit_price = src.unit_price, tgt.stock_quantity = src.stock_quantity, tgt.last_modified = src.last_modified WHEN NOT MATCHED THEN INSERT (product_id, product_name, category_id, unit_price, stock_quantity, last_modified) VALUES (src.product_id, src.product_name, src.category_id, src.unit_price, src.stock_quantity, src.last_modified); 