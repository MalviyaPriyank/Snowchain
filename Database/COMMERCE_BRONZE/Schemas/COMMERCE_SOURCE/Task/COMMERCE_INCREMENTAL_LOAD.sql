   CREATE TASK COMMERCE_BRONZE.COMMERCE_SOURCE.COMMERCE_INCREMENTAL_LOAD  WAREHOUSE = COMPUTE_WH  SCHEDULE = 'USING CRON 0 8 * * * America/Los_Angeles'  COMMENT = 'Task to load incremental data from source to target tables'  AS  BEGIN MERGE INTO COMMERCE_TARGET.CUSTOMERS t USING COMMERCE_SOURCE.CUSTOMERS_STREAM s ON t.customer_id = s.customer_id WHEN MATCHED THEN UPDATE SET t.first_name = s.first_name, t.last_name = s.last_name, t.email = s.email, t.phone = s.phone, t.date_joined = s.date_joined WHEN NOT MATCHED THEN INSERT (customer_id, first_name, last_name, email, phone, date_joined) VALUES (s.customer_id, s.first_name, s.last_name, s.email, s.phone, s.date_joined); MERGE INTO COMMERCE_TARGET.PRODUCTS t USING COMMERCE_SOURCE.PRODUCTS_STREAM s ON t.product_id = s.product_id WHEN MATCHED THEN UPDATE SET t.product_name = s.product_name, t.category_id = s.category_id, t.unit_price = s.unit_price, t.stock_quantity = s.stock_quantity WHEN NOT MATCHED THEN INSERT (product_id, product_name, category_id, unit_price, stock_quantity) VALUES (s.product_id, s.product_name, s.category_id, s.unit_price, s.stock_quantity); END; 