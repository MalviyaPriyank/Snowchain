   CREATE TASK SAMPLE_DB.DEMO_SCHEMA.INCREMENTAL_LOAD_TASK  WAREHOUSE = COMPUTE_WH  SCHEDULE = 'USING CRON 0 8 * * * America/New_York'  COMMENT = 'Task to load incremental data with deduplication'  AS  MERGE INTO TARGET_TABLE AS TGT USING (SELECT * FROM (SELECT *, ROW_NUMBER() OVER (PARTITION BY ID ORDER BY LAST_MODIFIED DESC) AS RN FROM SOURCE_TABLE WHERE LAST_MODIFIED > (SELECT COALESCE(MAX(LAST_MODIFIED), '1900-01-01'::TIMESTAMP) FROM TARGET_TABLE)) WHERE RN = 1) AS SRC ON TGT.ID = SRC.ID WHEN MATCHED THEN UPDATE SET TGT.NAME = SRC.NAME, TGT.EMAIL = SRC.EMAIL, TGT.AMOUNT = SRC.AMOUNT, TGT.LAST_MODIFIED = SRC.LAST_MODIFIED WHEN NOT MATCHED THEN INSERT (ID, NAME, EMAIL, AMOUNT, LAST_MODIFIED) VALUES (SRC.ID, SRC.NAME, SRC.EMAIL, SRC.AMOUNT, SRC.LAST_MODIFIED) 